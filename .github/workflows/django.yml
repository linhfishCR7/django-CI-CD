# name: Django CI

# on:
#   push:
#     branches: [ "main" ]
#   pull_request:
#     branches: [ "main" ]

# jobs:
#   build:

#     runs-on: ubuntu-latest
#     strategy:
#       max-parallel: 4
#       matrix:
#         python-version: [3.9]

#     steps:
#     - uses: actions/checkout@v3
#     - name: Set up Python ${{ matrix.python-version }}
#       uses: actions/setup-python@v3
#       with:
#         python-version: ${{ matrix.python-version }}
#     - name: Install Dependencies
#       run: |
#         python -m pip install --upgrade pip
#         pip install -r requirements.txt
#     - name: Run Tests
#       run: |
#         python manage.py test

#   sonarcloud:
#     name: SonarCloud
#     runs-on: ubuntu-latest
#     needs: build
#     steps:
#       - uses: actions/checkout@v3
#         with:
#           fetch-depth: 0
#       - name: SonarCloud Scan
#         uses: SonarSource/sonarcloud-github-action@master
#         env:
#           GITHUB_TOKEN: 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 # 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
#           SONAR_TOKEN: e2e061fbd646fee3e630559dd66f2ab20e4c0f44 # e2e061fbd646fee3e630559dd66f2ab20e4c0f44
#         with:
#           args:
#             -Dsonar.projectKey=linhfishCR7_django-CI-CD
#             -Dsonar.organization=linhfishcr7

#   Deployment:
#     runs-on: ubuntu-latest
#     env:
#       HEROKU_API_KEY: 475cf568-e754-43f6-8b94-4edded302c4e # 475cf568-e754-43f6-8b94-4edded302c4e
#       HEROKU_APP_NAME: django-ci-cd-123 # django-ci-cd-123
#     steps:
#     - uses: actions/checkout@v3
#     - name: Set up Ruby 2.7
#       uses: actions/setup-ruby@v1
#       with:
#         ruby-version: 2.7
#     - name: Install dpl
#       run: gem install dpl
#     - name: Install Heroku CLI
#       run: wget -qO- https://cli-assets.heroku.com/install-ubuntu.sh | sh
#     - name: Disable collectstatic
#       run: heroku config:set DISABLE_COLLECTSTATIC=1 --app django-ci-cd-123
#     - name: Deploy to Heroku
#       run: dpl --provider=heroku --app=django-ci-cd-123 --api-key=475cf568-e754-43f6-8b94-4edded302c4e
#     - name: Run migrations
#       run: heroku run --app django-ci-cd-123 migrate
#     - uses: chrnorm/deployment-action@releases/v1
#       name: Create GitHub Deployment
#       with:
#         initial_status: success
#         token: ${{ github.token }}
#         target_url: https://django-ci-cd-123.herokuapp.com
#         environment: production